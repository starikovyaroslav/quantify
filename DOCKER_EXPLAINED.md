# Docker Compose - –û–±—ä—è—Å–Ω–µ–Ω–∏–µ –∫–æ–º–∞–Ω–¥

## üê≥ –ß—Ç–æ —Ç–∞–∫–æ–µ Docker Compose?

Docker Compose - —ç—Ç–æ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ. –í–º–µ—Å—Ç–æ –∑–∞–ø—É—Å–∫–∞ –∫–∞–∂–¥–æ–≥–æ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ –æ—Ç–¥–µ–ª—å–Ω–æ, –≤—ã –æ–ø–∏—Å—ã–≤–∞–µ—Ç–µ –≤—Å–µ —Å–µ—Ä–≤–∏—Å—ã –≤ —Ñ–∞–π–ª–µ `docker-compose.yml` –∏ –∑–∞–ø—É—Å–∫–∞–µ—Ç–µ –∏—Ö –æ–¥–Ω–æ–π –∫–æ–º–∞–Ω–¥–æ–π.

## üìã –ö–æ–º–∞–Ω–¥–∞ `docker-compose up -d`

### –†–∞–∑–±–æ—Ä –∫–æ–º–∞–Ω–¥—ã

```bash
docker-compose up -d
```

**–†–∞–∑–±–µ—Ä–µ–º –ø–æ —á–∞—Å—Ç—è–º:**

1. **`docker-compose`** - —Å–∞–º–∞ –ø—Ä–æ–≥—Ä–∞–º–º–∞ Docker Compose
2. **`up`** - –∫–æ–º–∞–Ω–¥–∞ "–ø–æ–¥–Ω—è—Ç—å" (–∑–∞–ø—É—Å—Ç–∏—Ç—å) –≤—Å–µ —Å–µ—Ä–≤–∏—Å—ã
3. **`-d`** - —Ñ–ª–∞–≥ "detached mode" (—Ñ–æ–Ω–æ–≤—ã–π —Ä–µ–∂–∏–º)

### –ß—Ç–æ –¥–µ–ª–∞–µ—Ç –∫–æ–º–∞–Ω–¥–∞?

1. **–ß–∏—Ç–∞–µ—Ç `docker-compose.yml`** - –Ω–∞—Ö–æ–¥–∏—Ç –≤—Å–µ –æ–ø–∏—Å–∞–Ω–Ω—ã–µ —Å–µ—Ä–≤–∏—Å—ã
2. **–°–æ–∑–¥–∞–µ—Ç —Å–µ—Ç–∏** - –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç —Å–µ—Ç—å –º–µ–∂–¥—É –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞–º–∏
3. **–°–æ–∑–¥–∞–µ—Ç volumes** - –ø–æ–¥–≥–æ—Ç–∞–≤–ª–∏–≤–∞–µ—Ç —Ö—Ä–∞–Ω–∏–ª–∏—â–∞ –¥–∞–Ω–Ω—ã—Ö
4. **–°–æ–±–∏—Ä–∞–µ—Ç –æ–±—Ä–∞–∑—ã** (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ) - –∫–æ–º–ø–∏–ª–∏—Ä—É–µ—Ç Dockerfile'—ã
5. **–ó–∞–ø—É—Å–∫–∞–µ—Ç –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã** - —Å—Ç–∞—Ä—Ç—É–µ—Ç –≤—Å–µ —Å–µ—Ä–≤–∏—Å—ã
6. **–†–∞–±–æ—Ç–∞–µ—Ç –≤ —Ñ–æ–Ω–µ** (`-d`) - –Ω–µ –±–ª–æ–∫–∏—Ä—É–µ—Ç —Ç–µ—Ä–º–∏–Ω–∞–ª

### –§–ª–∞–≥ `-d` (detached mode)

**–ë–µ–∑ `-d`:**
```bash
docker-compose up
```
- –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –∑–∞–ø—É—Å–∫–∞—é—Ç—Å—è –≤ **–ø–µ—Ä–µ–¥–Ω–µ–º –ø–ª–∞–Ω–µ**
- –õ–æ–≥–∏ –≤—ã–≤–æ–¥—è—Ç—Å—è –ø—Ä—è–º–æ –≤ —Ç–µ—Ä–º–∏–Ω–∞–ª
- –ü—Ä–∏ –∑–∞–∫—Ä—ã—Ç–∏–∏ —Ç–µ—Ä–º–∏–Ω–∞–ª–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –º–æ–≥—É—Ç –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—å—Å—è
- –ù—É–∂–Ω–æ –Ω–∞–∂–∞—Ç—å `Ctrl+C` —á—Ç–æ–±—ã –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—å

**–° `-d`:**
```bash
docker-compose up -d
```
- –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –∑–∞–ø—É—Å–∫–∞—é—Ç—Å—è –≤ **—Ñ–æ–Ω–æ–≤–æ–º —Ä–µ–∂–∏–º–µ**
- –¢–µ—Ä–º–∏–Ω–∞–ª –æ—Å–≤–æ–±–æ–∂–¥–∞–µ—Ç—Å—è —Å—Ä–∞–∑—É
- –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã —Ä–∞–±–æ—Ç–∞—é—Ç –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç —Ç–µ—Ä–º–∏–Ω–∞–ª–∞
- –ú–æ–∂–Ω–æ –∑–∞–∫—Ä—ã—Ç—å —Ç–µ—Ä–º–∏–Ω–∞–ª - –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –ø—Ä–æ–¥–æ–ª–∂–∞—Ç —Ä–∞–±–æ—Ç–∞—Ç—å

## üîç –ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ?

–î–ª—è –ø—Ä–æ–µ–∫—Ç–∞ QuantTxt –∫–æ–º–∞–Ω–¥–∞ `docker-compose up -d` –∑–∞–ø—É—Å–∫–∞–µ—Ç:

1. **Redis** - –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –æ—á–µ—Ä–µ–¥–µ–π
2. **PostgreSQL** - –æ—Å–Ω–æ–≤–Ω–∞—è –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
3. **API** (FastAPI) - –±—ç–∫–µ–Ω–¥ —Å–µ—Ä–≤–µ—Ä
4. **Worker** (Celery) - –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –∑–∞–¥–∞—á
5. **Frontend** (Next.js) - —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
6. **Nginx** - –≤–µ–±-—Å–µ—Ä–≤–µ—Ä –∏ reverse proxy
7. **Prometheus** - —Å–±–æ—Ä –º–µ—Ç—Ä–∏–∫
8. **Grafana** - –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –º–µ—Ç—Ä–∏–∫

–í—Å–µ —ç—Ç–æ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è **–æ–¥–Ω–æ–π –∫–æ–º–∞–Ω–¥–æ–π** –≤–º–µ—Å—Ç–æ 8 –æ—Ç–¥–µ–ª—å–Ω—ã—Ö –∫–æ–º–∞–Ω–¥!

## üìä –ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞

```bash
# –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –∫–∞–∫–∏–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –∑–∞–ø—É—â–µ–Ω—ã
docker-compose ps

# –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ª–æ–≥–∏
docker-compose logs

# –õ–æ–≥–∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞
docker-compose logs api
docker-compose logs frontend

# –õ–æ–≥–∏ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
docker-compose logs -f api
```

### –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ

```bash
# –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –≤—Å–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã (–Ω–æ –Ω–µ —É–¥–∞–ª—è—Ç—å)
docker-compose stop

# –ó–∞–ø—É—Å—Ç–∏—Ç—å –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã
docker-compose start

# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –≤—Å–µ
docker-compose restart

# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π —Å–µ—Ä–≤–∏—Å
docker-compose restart api
```

### –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ —É–¥–∞–ª–µ–Ω–∏–µ

```bash
# –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∏ —É–¥–∞–ª–∏—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã (–¥–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è)
docker-compose down

# –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∏ —É–¥–∞–ª–∏—Ç—å –í–°–ï (–≤–∫–ª—é—á–∞—è –¥–∞–Ω–Ω—ã–µ!)
docker-compose down -v
```

### –ü–µ—Ä–µ—Å–±–æ—Ä–∫–∞

```bash
# –ü–µ—Ä–µ—Å–æ–±—Ä–∞—Ç—å –æ–±—Ä–∞–∑—ã –∏ –∑–∞–ø—É—Å—Ç–∏—Ç—å
docker-compose up -d --build

# –ü–µ—Ä–µ—Å–æ–±—Ä–∞—Ç—å —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω —Å–µ—Ä–≤–∏—Å
docker-compose up -d --build api
```

## üéØ –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –ü–µ—Ä–≤—ã–π –∑–∞–ø—É—Å–∫

```bash
# 1. –ó–∞–ø—É—Å—Ç–∏—Ç—å –≤—Å–µ —Å–µ—Ä–≤–∏—Å—ã
docker-compose up -d

# 2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å
docker-compose ps

# 3. –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ª–æ–≥–∏ (–µ—Å–ª–∏ —á—Ç–æ-—Ç–æ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç)
docker-compose logs
```

### –ü–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤ –∫–æ–¥–µ

```bash
# –ü–µ—Ä–µ—Å–æ–±—Ä–∞—Ç—å –∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å
docker-compose up -d --build

# –ò–ª–∏ —Ç–æ–ª—å–∫–æ –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å (–µ—Å–ª–∏ –∫–æ–¥ —É–∂–µ –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ)
docker-compose restart api
```

### –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –Ω–∞ –Ω–æ—á—å

```bash
# –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –≤—Å–µ (–¥–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è)
docker-compose stop

# –£—Ç—Ä–æ–º –∑–∞–ø—É—Å—Ç–∏—Ç—å —Å–Ω–æ–≤–∞
docker-compose start
```

## üîß –ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ø–æ–¥ –∫–∞–ø–æ—Ç–æ–º?

–ö–æ–≥–¥–∞ –≤—ã –∑–∞–ø—É—Å–∫–∞–µ—Ç–µ `docker-compose up -d`:

1. **–ü—Ä–æ–≤–µ—Ä–∫–∞ —Ñ–∞–π–ª–∞** - —á–∏—Ç–∞–µ—Ç—Å—è `docker-compose.yml`
2. **–°–æ–∑–¥–∞–Ω–∏–µ —Å–µ—Ç–∏** - —Å–æ–∑–¥–∞–µ—Ç—Å—è –≤–∏—Ä—Ç—É–∞–ª—å–Ω–∞—è —Å–µ—Ç—å `quanttxt-network`
3. **–°–æ–∑–¥–∞–Ω–∏–µ volumes** - –ø–æ–¥–≥–æ—Ç–∞–≤–ª–∏–≤–∞—é—Ç—Å—è —Ö—Ä–∞–Ω–∏–ª–∏—â–∞ –¥–ª—è –¥–∞–Ω–Ω—ã—Ö
4. **–ü—Ä–æ–≤–µ—Ä–∫–∞ –æ–±—Ä–∞–∑–æ–≤** - –µ—Å–ª–∏ –æ–±—Ä–∞–∑–æ–≤ –Ω–µ—Ç, –æ–Ω–∏ —Å–æ–±–∏—Ä–∞—é—Ç—Å—è –∏–∑ Dockerfile
5. **–ó–∞–ø—É—Å–∫ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤** - –∫–∞–∂–¥—ã–π —Å–µ—Ä–≤–∏—Å –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –≤ —Å–≤–æ–µ–º –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ
6. **–ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π** - —Å–µ—Ä–≤–∏—Å—ã –∂–¥—É—Ç —Å–≤–æ–∏—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π (–Ω–∞–ø—Ä–∏–º–µ—Ä, API –∂–¥–µ—Ç Redis)
7. **Health checks** - –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –∑–¥–æ—Ä–æ–≤—å–µ —Å–µ—Ä–≤–∏—Å–æ–≤

## ‚ö†Ô∏è –í–∞–∂–Ω—ã–µ –º–æ–º–µ–Ω—Ç—ã

### –ü–æ—Ä—Ç—ã

–ï—Å–ª–∏ –ø–æ—Ä—Ç –∑–∞–Ω—è—Ç, –≤—ã —É–≤–∏–¥–∏—Ç–µ –æ—à–∏–±–∫—É:
```
Error: bind: address already in use
```

**–†–µ—à–µ–Ω–∏–µ:** –∏–∑–º–µ–Ω–∏—Ç–µ –ø–æ—Ä—Ç –≤ `docker-compose.yml` –∏–ª–∏ –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –ø—Ä–æ–≥—Ä–∞–º–º—É, –∫–æ—Ç–æ—Ä–∞—è –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –ø–æ—Ä—Ç.

### –î–∞–Ω–Ω—ã–µ

- **`docker-compose down`** - —É–¥–∞–ª—è–µ—Ç –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã, –Ω–æ **—Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –¥–∞–Ω–Ω—ã–µ** –≤ volumes
- **`docker-compose down -v`** - —É–¥–∞–ª—è–µ—Ç **–í–°–ï**, –≤–∫–ª—é—á–∞—è –¥–∞–Ω–Ω—ã–µ!

### –õ–æ–≥–∏

–õ–æ–≥–∏ —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞—Ö. –ü–æ—Å–ª–µ `docker-compose down` –æ–Ω–∏ —É–¥–∞–ª—è—é—Ç—Å—è.
–ß—Ç–æ–±—ã —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –ª–æ–≥–∏:
```bash
docker-compose logs > logs.txt
```

## üìö –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã

- [Docker Compose –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è](https://docs.docker.com/compose/)
- [Docker Compose CLI reference](https://docs.docker.com/compose/reference/)


